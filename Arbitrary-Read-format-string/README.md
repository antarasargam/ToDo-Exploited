Authors @Antara Sargam @Venkata Aditya B. @Binjie Li

Arbitrary Read or Information Leak Exploit:
--------------------------------------------

Description of vulnerable application:
-------------------------------------

To perform a successful information leak exploit, a simple command line tool ToDo was used. The tainted buffer created was passed in a printf
function placed in deleteTodo function, making the application vulnerable. 

Description of exploit:
-----------------------

The aim of this exploit was to attack the format string vulnerability in the printf command to leak information from the stack and in turn access the contents of a specific memory address.
We created our tainted buffer for the printf function under deleteTodo function. The tainted buffer consisted of the address of the variable (buffer) whose contents were to be read,
followed by an offset value (in decimals) that was calculated based on the distance between the printf's internal pointer and the location of
the address that was passed in as user input for the same printf function. 
This calculated value was used in conjunction with a $. (Ref: https://www.exploit-db.com/docs/28476.pdf)
In order to read the contents of the address that was passed in, a %s was used.

Build Instructions:
-------------------

The exploit code has been added to the application's todo.c file. We have renamed the application's main() function to real_main() which consists the application program and our exploit code is added in the main() function.

The application is under the following directory: /home/student/Downloads/arb_read/ and in this repository as well.

Demonstration Sequence:
-----------------------

To run the program, and exploit the same, the following steps must be followed:

1. Compile the program using the following command: 

gcc -m32 -z execstack -fno-stack-protector -Wno-format-security todo.c -o todo

2. We have created a variable inside our exploit code with a string inside it and have aimed to read the contents of that string using the format string

3. The memory address of the variable has been hard coded in our tainted buffer. 

4. We have exploited the deleteTodo function in the application.

5. To run the exploit, use the following command: 

./todo del exploit

6. The program will output the contents of the variable located at the memory address hard coded in our exploit code.

6. The application runs perfectly fine if we pass any argument apart from "exploit" and the functionality of the application is not changed.

 Limitations of the exploit:
1. The user cannot input any address that he would like to read as the address has been hardcoded into the program.
2. The exploit cannot run on different platform because of the stack address change.
